
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="LDFbsFtoiZlBNqruvC2wK8sObZtsKGqwvzvcPB0y1mE" />
    <meta name="yandex-verification" content="7c0f79b635678935" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WJH9XZY2MY"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WJH9XZY2MY');
    </script>

    <title>sheldon&#39;s ansys.net-macro</title>
    <script defer src="https://use.fontawesome.com/releases/v5.7.2/js/all.js" integrity="sha384-0pzryjIRos8mFBWMzSSZApWtPl/5++eIfzYmTgBBmXYdhvxPc+XcFEk+zJwDgWbP" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/style.css"/>

    <script async src="https://cse.google.com/cse.js?cx=904d4317f81cbaf46"></script>

    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="ansys.net">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="ansys.net">

    <title>sheldon&#39;s ansys.net</title>
  </head>
  <body class="bg-success">
    <nav class="site-nav family-sans navbar navbar-expand-md bg-success navbar-dark sticky-top py-0">
  <div class="container-fluid">

    <button type="button" class="navbar-toggler my-2 my-md-0"
      data-toggle="collapse" data-target="#myTogglerNav"
      aria-controls="myTogglerNav" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="navbar-brand text-uppercase">
      <a class="text-light" href="/">ANSYS</a>
    </div>

    <div class="collapse navbar-collapse text-center mt-0" id="myTogglerNav">
      <div class="navbar-nav ml-auto font-weight-regular text-uppercase">
        <a class="nav-item nav-link" href="/"><i class="fas fa-home"></i></a>

        <a class="nav-item nav-link" href="/macros/0/">macros</a><a class="nav-item nav-link" href="/examples/0/">examples</a><a class="nav-item nav-link" href="/resources/0/">resources</a><a class="nav-item nav-link" href="/miscellaneous/0/">misc</a><a class="nav-item nav-link" href="/html/0">HTML</a>
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
            <a class="dropdown-item text-capitalize" href="/about">About</a>
            <div class="dropdown-divider"></div><a class="dropdown-item text-capitalize" target="_blank" href="https://github.com/affinitylinks/ansys.net">
                <i class="fab fa-github text-secondary mr-2"></i>github
              </a></div>
        </div>

      </div>
    </div>

  </div>
</nav>

    <div class="row">
      <div class="col">
        <div class="bg-light">
          <div class="conatainer">
            <div class="gcse-search">...</div>
          </div>
          
<main class="container py-4">
  <h1 class="mb-3 text-center">Macros</h1>
<nav class="my-3" aria-label="Page navigation">
  <div class="pagination pagination-sm justify-content-center">
  <div class="page-item">
    <a class="page-link" href="/macros/4/index.html"><i class="fas fa-arrow-left"></i></a>
  </div>
  <div class="page-item "><a class="page-link" href="/macros/0/index.html">1</a></div>
  <div class="page-item "><a class="page-link" href="/macros/1/index.html">2</a></div>
  <div class="page-item "><a class="page-link" href="/macros/2/index.html">3</a></div>
  <div class="page-item "><a class="page-link" href="/macros/3/index.html">4</a></div>
  <div class="page-item "><a class="page-link" href="/macros/4/index.html">5</a></div>
  <div class="page-item active"><a class="page-link" href="/macros/5/index.html">6</a></div>
  <div class="page-item "><a class="page-link" href="/macros/6/index.html">7</a></div>
  <div class="page-item "><a class="page-link" href="/macros/7/index.html">8</a></div>
  <div class="page-item">
    <a class="page-link" href="/macros/6/index.html"><i class="fas fa-arrow-right"></i></a>
  </div>
  </div>
</nav>
<ul class="list-group"><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/6/p_protec.mac" target="_blank"> p_protec.mac</a></p>
<p class="font-italic">Chris Kennedy (Think PEAK, Inc.)</p>
<p>Used as a &quot;wrapper&quot; for SAVE and RESUME in Toolbar, so one doesn't inadvertantly overwrite stuff in memory.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/2/para-2.mac" target="_blank"> para-2.mac</a></p>
<p class="font-italic"></p>
<p>para-2.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/5/peri3d.mac" target="_blank"> peri3d.mac</a></p>
<p class="font-italic"></p>
<p>peri3d.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/6/picker.mac" target="_blank"> picker.mac</a></p>
<p class="font-italic"></p>
<p>picker.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/4/plot_tag.mac" target="_blank"> plot_tag.mac</a></p>
<p class="font-italic">Mark Tate (Hamilton Sundstrand)</p>
<p>This macro will tag your plots with directory and jobname.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/5/plrv.mac" target="_blank"> plrv.mac</a></p>
<p class="font-italic"></p>
<p>plrv.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/6/plvln.mac" target="_blank"> plvln.mac</a></p>
<p class="font-italic"></p>
<p>plvln.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/3/pressure.mac" target="_blank"> pressure.mac</a></p>
<p class="font-italic"></p>
<p>pressure.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/8/pringet.mac" target="_blank"> pringet.mac</a></p>
<p class="font-italic"></p>
<p>pringet.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/0/prnwp.mac" target="_blank"> prnwp.mac</a></p>
<p class="font-italic"></p>
<p>prnwp.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/2/psdout.mac" target="_blank"> psdout.mac</a></p>
<p class="font-italic"></p>
<p>psdout.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/3/put_amp.mac" target="_blank"> put_amp.mac</a></p>
<p class="font-italic"></p>
<p>put_amp.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/7/qclear.mac" target="_blank"> qclear.mac</a></p>
<p class="font-italic">Rod Scholl (PADT)</p>
<p>Does a /CLEAR without prompting the user for an OK</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/8/qzmulti.mac" target="_blank"> qzmulti.mac</a></p>
<p class="font-italic"></p>
<p>qzmulti.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/2/random.mac" target="_blank"> random.mac</a></p>
<p class="font-italic"></p>
<p>random.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/3/randseed.mac" target="_blank"> randseed.mac</a></p>
<p class="font-italic">Stefan Reh (ANSYS, Inc.)</p>
<p>&quot;All random number generators are only pseudo-random number generators. They use what is called a &quot;seed&quot; value to calculate a random number. The result is only pseudo-random because with the same seed value you will always end up with the same &quot;random&quot; number. So whenever you start ANSYS it initializes the seed value. If you start generating random numbers then you will always get the same sequence of &quot;random&quot; numbers. The solution to this problem is to randomize the seed value itself using the system-time. Enclosed is the macro &quot;randseed&quot; that will exactly do that. You will get &quot;real&quot; random numbers after you run &quot;randseed&quot;. You might want to run this macro every time before you start with your random number generation. You can also include the macro in your &quot;start.ans&quot; procedure so it will be executed each time you start ANSYS.&quot;<br>
It effectively randomizes the seed by executing the RAND an arbitrary number of times.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/6/rcs2ics.mac" target="_blank"> rcs2ics.mac</a></p>
<p class="font-italic"></p>
<p>rcs2ics.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/7/rcyl.mac" target="_blank"> rcyl.mac</a></p>
<p class="font-italic"></p>
<p>rcyl.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/0/readsi.mac" target="_blank"> readsi.mac</a></p>
<p class="font-italic"></p>
<p>readsi.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/1/reassign.mac" target="_blank"> reassign.mac</a></p>
<p class="font-italic">Sheldon Imaoka (CSI)</p>
<p>Example of reassigning matrix scratch files to another directory. For this example, I also differentiate between the platform type when specifying a scratch directory since Windows and UNIX file systems are assigned differently.<br>
Requires jobname macro.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/2/reformat.mac" target="_blank"> reformat.mac</a></p>
<p class="font-italic"></p>
<p>reformat.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/3/renam.mac" target="_blank"> renam.mac</a></p>
<p class="font-italic">John Swanson (SAS, Inc./ANSYS, Inc.)</p>
<p>Renames files in working directory. For example, using &quot;renam,'tif',_1&quot; renames all TIF files in working directory and adds prefix &quot;_1&quot;. Useful to rename graphics files. (Note: At 5.6.1, the undocumented command /DIRGET which this macro uses does not work on Windows and will result in an abort.)</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/0/rfor_total.mac" target="_blank"> rfor_total.mac</a></p>
<p class="font-italic"></p>
<p>rfor_total.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/4/rotv.mac" target="_blank"> rotv.mac</a></p>
<p class="font-italic"></p>
<p>rotv.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/5/round.mac" target="_blank"> round.mac</a></p>
<p class="font-italic">Gordon May (Rolls Royce Compressor Key System)</p>
<p>Macro to round a parameter to a specified number of digits.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/6/rparea.mac" target="_blank"> rparea.mac</a></p>
<p class="font-italic"></p>
<p>rparea.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/6/sasel.mac" target="_blank"> sasel.mac</a></p>
<p class="font-italic">Sheldon Imaoka (ANSYS, Inc.)</p>
<p>Macro used to select areas based on the value of the area itself (=length^2). Can be used to select all areas of a certain surface area or a range of surface area (with tolerance).</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/7/scopy.mac" target="_blank"> scopy.mac</a></p>
<p class="font-italic"></p>
<p>scopy.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/0/select_hexpyra.mac" target="_blank"> select_hexpyra.mac</a></p>
<p class="font-italic">SELECT_HEXPYRA</p>
<p>Simple example to unselect tetrahedral and wedge-shaped SOLID164 degenerate elements, leaving only hexahedral and pyramid SOLID164 selected.</p>
<p>While this macro has limited usefulness by itself, it can be used as an example of selecting certain element shapes by nodal connectivity - very useful if you have a single element type but multiple degenerate element shapes and want to differentiate between them in your model.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/1/selloc.mac" target="_blank"> selloc.mac</a></p>
<p class="font-italic">Don Shaffer (Siemens Westinghouse Power Corp)</p>
<p>&quot;This is a utility tool to speed up selection of model entities by location.&quot; Please read the comments in the macro file for more details on usage.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/2/seqv_max.mac" target="_blank"> seqv_max.mac</a></p>
<p class="font-italic"></p>
<p>seqv_max.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/3/setLegend.js" target="_blank"> setLegend.js</a></p>
<p class="font-italic"></p>
<p>setLegend.js</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/4/setScale.js" target="_blank"> setScale.js</a></p>
<p class="font-italic"></p>
<p>setScale.js</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/7/sfmap.mac" target="_blank"> sfmap.mac</a></p>
<p class="font-italic">(CAEAI)</p>
<p>&quot;This macro is used to map pressure from a CFD mesh onto a structural mesh. The point XYZ locations from the CFD analysis must exist in an array called cfdxyz(npts,3). A corresponding array called &quot;cfdpres&quot; must be exist also. This array contains the pressure values corresponding to the point locations.&quot;<br>
Useful example of the use of *MOPER,,,MAP.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/3/shownres.mac" target="_blank"> shownres.mac</a></p>
<p class="font-italic"></p>
<p>shownres.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/6/siresume.mac" target="_blank"> siresume.mac</a></p>
<p class="font-italic">Sheldon Imaoka (CSI</p>
<p>Use this for the RESUM_DB abbreviation in the Toolbar to prevent accidental resuming (which clears contents of current database). This macro will not prompt user for confirmation is database is blank. Otherwise, it will prompt user to verify that he/she wants to resume.</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/8/skin.mac" target="_blank"> skin.mac</a></p>
<p class="font-italic"></p>
<p>skin.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/1/skndpth.mac" target="_blank"> skndpth.mac</a></p>
<p class="font-italic"></p>
<p>skndpth.mac</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/2/slicepln.mac" target="_blank"> slicepln.mac</a></p>
<p class="font-italic">Don Shaffer (Siemens Westinghouse Power Corp)</p>
<p>&quot;This macro moves the working plane origin to the specified keypoint and orients it with wz normal to the specified cartesian axis with x=1,y=2 and z=3.&quot;</p>
</li><li class="list-group-item">
<p><a href="https://github.com/affinitylinks/ansys.net/blob/main/5/sort2d.mac" target="_blank"> sort2d.mac</a></p>
<p class="font-italic">Ashok K. (EACoE, Bangalore)</p>
<p>Ansys macro to sort a given numeric array (2d)</p>
<p>I usually get all the nodal coordinates into an array (call it NodeInfo) with node numbers in col 1; X,Y and Z coords in columns 2, 3 and 4 respectively.</p>
<p>Then lets say I want to sort by the Z- coord followed by the X-coord and then the Y-coord I call the macro</p>
<p>sort_by_cols, 'NodeInfo', 4,2,3</p>
<p>The tolerance is something which you may or may not need. Depends on your application. If you just want to compare upto full decimal accuracy leave the tolerance value at zero.</p>
</li></ul>
<nav class="my-3" aria-label="Page navigation">
  <div class="pagination pagination-sm justify-content-center">
  <div class="page-item">
    <a class="page-link" href="/macros/4/index.html"><i class="fas fa-arrow-left"></i></a>
  </div>
  <div class="page-item "><a class="page-link" href="/macros/0/index.html">1</a></div>
  <div class="page-item "><a class="page-link" href="/macros/1/index.html">2</a></div>
  <div class="page-item "><a class="page-link" href="/macros/2/index.html">3</a></div>
  <div class="page-item "><a class="page-link" href="/macros/3/index.html">4</a></div>
  <div class="page-item "><a class="page-link" href="/macros/4/index.html">5</a></div>
  <div class="page-item active"><a class="page-link" href="/macros/5/index.html">6</a></div>
  <div class="page-item "><a class="page-link" href="/macros/6/index.html">7</a></div>
  <div class="page-item "><a class="page-link" href="/macros/7/index.html">8</a></div>
  <div class="page-item">
    <a class="page-link" href="/macros/6/index.html"><i class="fas fa-arrow-right"></i></a>
  </div>
  </div>
</nav>


</main>

        </div>
      </div>
    </div>
    <nav class="nav-social navbar navbar-expand navbar-dark justify-content-center">
  <div class="navbar-nav"><a class="nav-item nav-link" target="_blank" href="https://github.com/affinitylinks/ansys.net">
      <i class="nav-social-icon fab fa-github mr-2"></i>
      <span class="align-text-bottom text-white d-none d-lg-inline">github</span>
    </a></div>
</nav>

  </body>
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
</html>
